{"ast":null,"code":"// frontend/src/UpcomingCleaningTasks.js\nimport React,{useState,useEffect}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function UpcomingCleaningTasks(){const[tasks,setTasks]=useState([]);const[reservations,setReservations]=useState([]);const[expandedReservation,setExpandedReservation]=useState(null);// Fetch cleaning tasks and reservations from the backend\nuseEffect(()=>{axios.get('http://localhost:5001/api/cleaning-schedule').then(response=>setTasks(response.data)).catch(error=>console.error('Error fetching cleaning tasks:',error));axios.get('http://localhost:5001/api/reservations').then(response=>setReservations(response.data)).catch(error=>console.error('Error fetching reservations:',error));},[]);// Calculate the date range: from today to 7 days from today\nconst today=new Date();today.setHours(0,0,0,0);const targetDate=new Date(today);targetDate.setDate(today.getDate()+7);// Filter tasks scheduled within the next 7 days\nconst upcomingTasks=tasks.filter(task=>{const taskDate=new Date(task.cleaningDate);return taskDate>=today&&taskDate<=targetDate;});// Merge each task with its corresponding reservation details (if available)\nconst mergedTasks=upcomingTasks.map(task=>{const reservation=reservations.find(r=>r.id===Number(task.reservationId));return{...task,reservation};});// Group tasks by reservationId\nconst groupedByReservation=mergedTasks.reduce((groups,task)=>{const resId=task.reservationId;if(!groups[resId]){groups[resId]=[];}groups[resId].push(task);return groups;},{});// Toggle expanded view for a reservation group\nconst toggleExpanded=resId=>{setExpandedReservation(prev=>prev===resId?null:resId);};// Mark a specific cleaning task as cleaned\nconst markTaskCleaned=taskId=>{axios.put(`http://localhost:5001/api/cleaning-schedule/task/${taskId}`,{completed:true}).then(response=>{alert(response.data.message);// Refresh tasks list after update\naxios.get('http://localhost:5001/api/cleaning-schedule').then(resp=>setTasks(resp.data)).catch(err=>console.error('Error refreshing tasks:',err));}).catch(error=>console.error('Error updating task:',error));};// Sort reservation groups by the check-out date of the first task in each group\nconst sortedReservationIds=Object.keys(groupedByReservation).sort((a,b)=>{const dateA=new Date(groupedByReservation[a][0].cleaningDate);const dateB=new Date(groupedByReservation[b][0].cleaningDate);return dateA-dateB;});return/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:'800px',margin:'auto',padding:'20px',fontFamily:'Arial, sans-serif'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{textAlign:'center',color:'#333'},children:\"Upcoming Cleaning Tasks (Next 7 Days)\"}),sortedReservationIds.length===0?/*#__PURE__*/_jsx(\"p\",{style:{textAlign:'center'},children:\"No cleaning tasks scheduled in the next 7 days.\"}):sortedReservationIds.map(resId=>{const tasksForRes=groupedByReservation[resId];const reservation=tasksForRes[0].reservation;return/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px',border:'1px solid #ccc',borderRadius:'8px',padding:'15px',backgroundColor:'#fff',boxShadow:'0 2px 6px rgba(0,0,0,0.1)'},children:[/*#__PURE__*/_jsxs(\"div\",{onClick:()=>toggleExpanded(resId),style:{cursor:'pointer',display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0',color:'#007BFF'},children:reservation?reservation.customerName:'Unknown Reservation'}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'4px 0 0',fontSize:'14px',color:'#555'},children:[\"Check-Out: \",tasksForRes[0].cleaningDate,\" 11:00 AM\"]})]}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'18px',color:'#007BFF'},children:expandedReservation===resId?'▲':'▼'})]}),expandedReservation===resId&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'10px'},children:[/*#__PURE__*/_jsx(\"p\",{style:{fontWeight:'bold'},children:\"Rooms to Clean:\"}),/*#__PURE__*/_jsx(\"ul\",{style:{listStyle:'none',padding:0},children:tasksForRes.map(task=>/*#__PURE__*/_jsxs(\"li\",{style:{marginBottom:'10px',display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"span\",{style:{fontSize:'15px'},children:[\"Room \",task.room,\" - \",task.completed?'Cleaned':'Pending']}),!task.completed&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>markTaskCleaned(task.taskId),style:{padding:'6px 10px',backgroundColor:'#28a745',color:'#fff',border:'none',borderRadius:'4px',cursor:'pointer',fontSize:'14px'},children:\"Mark as Cleaned\"})]},task.taskId))})]})]},resId);})]});}export default UpcomingCleaningTasks;","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","UpcomingCleaningTasks","tasks","setTasks","reservations","setReservations","expandedReservation","setExpandedReservation","get","then","response","data","catch","error","console","today","Date","setHours","targetDate","setDate","getDate","upcomingTasks","filter","task","taskDate","cleaningDate","mergedTasks","map","reservation","find","r","id","Number","reservationId","groupedByReservation","reduce","groups","resId","push","toggleExpanded","prev","markTaskCleaned","taskId","put","completed","alert","message","resp","err","sortedReservationIds","Object","keys","sort","a","b","dateA","dateB","style","maxWidth","margin","padding","fontFamily","children","textAlign","color","length","tasksForRes","marginBottom","border","borderRadius","backgroundColor","boxShadow","onClick","cursor","display","justifyContent","alignItems","customerName","fontSize","marginTop","fontWeight","listStyle","room"],"sources":["/Users/mosesle/Desktop/afc-housekeeping-project/frontend/src/UpcomingCleaningTasks.js"],"sourcesContent":["// frontend/src/UpcomingCleaningTasks.js\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nfunction UpcomingCleaningTasks() {\n  const [tasks, setTasks] = useState([]);\n  const [reservations, setReservations] = useState([]);\n  const [expandedReservation, setExpandedReservation] = useState(null);\n\n  // Fetch cleaning tasks and reservations from the backend\n  useEffect(() => {\n    axios.get('http://localhost:5001/api/cleaning-schedule')\n      .then(response => setTasks(response.data))\n      .catch(error => console.error('Error fetching cleaning tasks:', error));\n\n    axios.get('http://localhost:5001/api/reservations')\n      .then(response => setReservations(response.data))\n      .catch(error => console.error('Error fetching reservations:', error));\n  }, []);\n\n  // Calculate the date range: from today to 7 days from today\n  const today = new Date();\n  today.setHours(0, 0, 0, 0);\n  const targetDate = new Date(today);\n  targetDate.setDate(today.getDate() + 7);\n\n  // Filter tasks scheduled within the next 7 days\n  const upcomingTasks = tasks.filter(task => {\n    const taskDate = new Date(task.cleaningDate);\n    return taskDate >= today && taskDate <= targetDate;\n  });\n\n  // Merge each task with its corresponding reservation details (if available)\n  const mergedTasks = upcomingTasks.map(task => {\n    const reservation = reservations.find(r => r.id === Number(task.reservationId));\n    return { ...task, reservation };\n  });\n\n  // Group tasks by reservationId\n  const groupedByReservation = mergedTasks.reduce((groups, task) => {\n    const resId = task.reservationId;\n    if (!groups[resId]) {\n      groups[resId] = [];\n    }\n    groups[resId].push(task);\n    return groups;\n  }, {});\n\n  // Toggle expanded view for a reservation group\n  const toggleExpanded = (resId) => {\n    setExpandedReservation(prev => (prev === resId ? null : resId));\n  };\n\n  // Mark a specific cleaning task as cleaned\n  const markTaskCleaned = (taskId) => {\n    axios.put(`http://localhost:5001/api/cleaning-schedule/task/${taskId}`, { completed: true })\n      .then(response => {\n        alert(response.data.message);\n        // Refresh tasks list after update\n        axios.get('http://localhost:5001/api/cleaning-schedule')\n          .then(resp => setTasks(resp.data))\n          .catch(err => console.error('Error refreshing tasks:', err));\n      })\n      .catch(error => console.error('Error updating task:', error));\n  };\n\n  // Sort reservation groups by the check-out date of the first task in each group\n  const sortedReservationIds = Object.keys(groupedByReservation).sort((a, b) => {\n    const dateA = new Date(groupedByReservation[a][0].cleaningDate);\n    const dateB = new Date(groupedByReservation[b][0].cleaningDate);\n    return dateA - dateB;\n  });\n\n  return (\n    <div style={{ maxWidth: '800px', margin: 'auto', padding: '20px', fontFamily: 'Arial, sans-serif' }}>\n      <h2 style={{ textAlign: 'center', color: '#333' }}>Upcoming Cleaning Tasks (Next 7 Days)</h2>\n      {sortedReservationIds.length === 0 ? (\n        <p style={{ textAlign: 'center' }}>No cleaning tasks scheduled in the next 7 days.</p>\n      ) : (\n        sortedReservationIds.map(resId => {\n          const tasksForRes = groupedByReservation[resId];\n          const reservation = tasksForRes[0].reservation;\n          return (\n            <div key={resId} style={{ marginBottom: '20px', border: '1px solid #ccc', borderRadius: '8px', padding: '15px', backgroundColor: '#fff', boxShadow: '0 2px 6px rgba(0,0,0,0.1)' }}>\n              <div onClick={() => toggleExpanded(resId)} style={{ cursor: 'pointer', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                <div>\n                  <h3 style={{ margin: '0', color: '#007BFF' }}>\n                    {reservation ? reservation.customerName : 'Unknown Reservation'}\n                  </h3>\n                  <p style={{ margin: '4px 0 0', fontSize: '14px', color: '#555' }}>\n                    Check-Out: {tasksForRes[0].cleaningDate} 11:00 AM\n                  </p>\n                </div>\n                <div style={{ fontSize: '18px', color: '#007BFF' }}>\n                  {expandedReservation === resId ? '▲' : '▼'}\n                </div>\n              </div>\n              {expandedReservation === resId && (\n                <div style={{ marginTop: '10px' }}>\n                  <p style={{ fontWeight: 'bold' }}>Rooms to Clean:</p>\n                  <ul style={{ listStyle: 'none', padding: 0 }}>\n                    {tasksForRes.map(task => (\n                      <li key={task.taskId} style={{ marginBottom: '10px', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                        <span style={{ fontSize: '15px' }}>Room {task.room} - {task.completed ? 'Cleaned' : 'Pending'}</span>\n                        {!task.completed && (\n                          <button \n                            onClick={() => markTaskCleaned(task.taskId)}\n                            style={{ padding: '6px 10px', backgroundColor: '#28a745', color: '#fff', border: 'none', borderRadius: '4px', cursor: 'pointer', fontSize: '14px' }}\n                          >\n                            Mark as Cleaned\n                          </button>\n                        )}\n                      </li>\n                    ))}\n                  </ul>\n                </div>\n              )}\n            </div>\n          );\n        })\n      )}\n    </div>\n  );\n}\n\nexport default UpcomingCleaningTasks;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}